<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Royal Bet üéÆ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ============================
           GLOBAL STYLES & VARIABLES
        ============================ */
        :root {
            --bg-primary: #0e1015;
            --bg-secondary: #15181f;
            --bg-tertiary: #1c1f2a;
            --accent-green: #00ff88;
            --accent-blue: #00a8ff;
            --accent-red: #ff4757;
            --accent-yellow: #ffd32a;
            --text-primary: #ffffff;
            --text-secondary: #8c94a3;
            --text-tertiary: #5a6270;
            --border-color: #2a2f3d;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: 80px; /* –î–ª—è –Ω–∏–∂–Ω–µ–≥–æ –º–µ–Ω—é */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
        }

        /* ============================
           TYPOGRAPHY
        ============================ */
        h1, h2, h3, h4 {
            font-weight: 700;
            line-height: 1.2;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 16px;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        h2 {
            font-size: 22px;
            margin-bottom: 12px;
        }

        h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        p {
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        small {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        /* ============================
           COMPONENTS
        ============================ */
        .card {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .card:hover {
            border-color: var(--accent-green);
            transform: translateY(-2px);
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            gap: 8px;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-green), #00cc6d);
            color: var(--bg-primary);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 136, 0.3);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .btn-danger {
            background: var(--accent-red);
            color: white;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn-block {
            width: 100%;
        }

        /* ============================
           HEADER & NAVIGATION
        ============================ */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 16px 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
            font-weight: 800;
        }

        .logo-icon {
            color: var(--accent-green);
            font-size: 28px;
        }

        .balance-display {
            background: linear-gradient(135deg, var(--bg-tertiary), #1a1d28);
            border-radius: var(--radius-md);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            border: 1px solid var(--border-color);
        }

        .balance-amount {
            color: var(--accent-green);
            font-size: 18px;
        }

        .tab-navigation {
            display: flex;
            overflow-x: auto;
            gap: 4px;
            padding: 16px 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .tab-navigation::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 12px 20px;
            white-space: nowrap;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            font-weight: 500;
            transition: var(--transition);
            cursor: pointer;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--accent-green), #00cc6d);
            color: var(--bg-primary);
            border-color: transparent;
        }

        .tab-btn i {
            margin-right: 8px;
        }

        /* ============================
           BOTTOM NAVIGATION
        ============================ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            background: rgba(21, 24, 31, 0.9);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
            transition: var(--transition);
            padding: 8px 16px;
            border-radius: var(--radius-md);
        }

        .nav-item.active {
            color: var(--accent-green);
            background: rgba(0, 255, 136, 0.1);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        /* ============================
           SPORTS SECTION
        ============================ */
        .sport-tabs {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            margin-bottom: 20px;
            padding-bottom: 8px;
            scrollbar-width: none;
        }

        .sport-tabs::-webkit-scrollbar {
            display: none;
        }

        .sport-tab {
            padding: 10px 20px;
            background: var(--bg-tertiary);
            border-radius: 50px;
            white-space: nowrap;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border: 1px solid transparent;
            cursor: pointer;
            transition: var(--transition);
        }

        .sport-tab.active {
            background: linear-gradient(135deg, var(--accent-green), #00cc6d);
            color: var(--bg-primary);
            border-color: transparent;
        }

        .match-card {
            position: relative;
            overflow: hidden;
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .match-sport {
            color: var(--accent-green);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .match-status {
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-live {
            background: rgba(255, 71, 87, 0.2);
            color: var(--accent-red);
            animation: pulse 2s infinite;
        }

        .status-scheduled {
            background: rgba(0, 168, 255, 0.2);
            color: var(--accent-blue);
        }

        .match-teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .team-logo {
            width: 48px;
            height: 48px;
            background: var(--bg-tertiary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            font-size: 20px;
        }

        .team-name {
            font-weight: 600;
            text-align: center;
            font-size: 14px;
        }

        .match-score {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 20px;
        }

        .score-display {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 4px;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .match-time {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .match-odds {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 20px;
        }

        .odds-btn {
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .odds-btn:hover {
            border-color: var(--accent-green);
            transform: translateY(-2px);
        }

        .odds-type {
            font-size: 11px;
            color: var(--text-tertiary);
            margin-bottom: 4px;
        }

        .odds-value {
            font-weight: 700;
            font-size: 16px;
            color: var(--accent-green);
        }

        /* ============================
           GAMES HUB
        ============================ */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 20px;
        }

        .game-card {
            background: linear-gradient(135deg, var(--bg-tertiary), #1a1d28);
            border-radius: var(--radius-lg);
            padding: 24px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: var(--transition);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 180px;
        }

        .game-card:hover {
            border-color: var(--accent-green);
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0, 255, 136, 0.2);
        }

        .game-icon {
            font-size: 48px;
            margin-bottom: 16px;
            color: var(--accent-green);
        }

        .game-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .game-description {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* ============================
           MINES GAME
        ============================ */
        .mines-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .mines-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: var(--radius-lg);
        }

        .mines-slider {
            flex: 1;
            margin: 0 20px;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: var(--accent-green);
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid var(--bg-primary);
        }

        .mines-count {
            font-size: 32px;
            font-weight: 800;
            color: var(--accent-green);
            min-width: 60px;
            text-align: center;
        }

        .mines-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .mine-cell {
            aspect-ratio: 1;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 800;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .mine-cell:hover {
            border-color: var(--accent-green);
            transform: scale(1.05);
        }

        .mine-cell.revealed {
            background: var(--accent-red);
            cursor: default;
        }

        .mine-cell.safe {
            background: var(--accent-green);
            color: var(--bg-primary);
            cursor: default;
        }

        .game-stats {
            display: flex;
            justify-content: space-between;
            background: var(--bg-tertiary);
            padding: 16px;
            border-radius: var(--radius-lg);
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent-green);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* ============================
           DICE GAME
        ============================ */
        .dice-container {
            max-width: 500px;
            margin: 0 auto;
            text-align: center;
        }

        .dice-3d {
            width: 150px;
            height: 150px;
            margin: 30px auto;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .dice-face {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--bg-tertiary);
            border: 2px solid var(--accent-green);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            font-weight: 800;
            color: var(--accent-green);
            backface-visibility: hidden;
        }

        .face-1 { transform: translateZ(75px); }
        .face-2 { transform: rotateY(90deg) translateZ(75px); }
        .face-3 { transform: rotateY(180deg) translateZ(75px); }
        .face-4 { transform: rotateY(-90deg) translateZ(75px); }
        .face-5 { transform: rotateX(90deg) translateZ(75px); }
        .face-6 { transform: rotateX(-90deg) translateZ(75px); }

        .dice-bets {
            display: flex;
            gap: 16px;
            margin: 30px 0;
        }

        .dice-bet-btn {
            flex: 1;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .dice-bet-btn.active {
            border-color: var(--accent-green);
            background: rgba(0, 255, 136, 0.1);
        }

        .dice-bet-icon {
            font-size: 36px;
            margin-bottom: 12px;
            color: var(--accent-green);
        }

        /* ============================
           CRASH GAME
        ============================ */
        .crash-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .crash-canvas-container {
            position: relative;
            margin-bottom: 24px;
        }

        #crashCanvas {
            width: 100%;
            height: 300px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            display: block;
        }

        .crash-multiplier {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: 800;
            color: var(--accent-green);
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .crash-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .auto-cashout {
            grid-column: span 2;
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: var(--radius-lg);
            text-align: center;
        }

        .auto-input {
            width: 100px;
            padding: 12px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            text-align: center;
            font-size: 18px;
            margin: 0 12px;
        }

        /* ============================
           PROFILE SECTION
        ============================ */
        .profile-header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, var(--bg-tertiary), #1a1d28);
            border-radius: var(--radius-lg);
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: var(--bg-primary);
        }

        .profile-balance {
            font-size: 48px;
            font-weight: 800;
            color: var(--accent-green);
            margin: 20px 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: var(--radius-lg);
            text-align: center;
        }

        .history-list {
            margin-top: 30px;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            margin-bottom: 12px;
            border-left: 4px solid transparent;
        }

        .history-item.won {
            border-left-color: var(--accent-green);
        }

        .history-item.lost {
            border-left-color: var(--accent-red);
        }

        .history-item.active {
            border-left-color: var(--accent-blue);
        }

        /* ============================
           MODALS & POPUPS
        ============================ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalAppear 0.3s ease-out;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            padding: 4px;
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--accent-red);
        }

        .bet-input-container {
            margin: 20px 0;
        }

        .bet-amount-input {
            width: 100%;
            padding: 20px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 32px;
            font-weight: 700;
            text-align: center;
            transition: var(--transition);
        }

        .bet-amount-input:focus {
            outline: none;
            border-color: var(--accent-green);
        }

        .quick-bets {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .quick-bet {
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .quick-bet:hover {
            border-color: var(--accent-green);
        }

        /* ============================
           UTILITIES & ANIMATIONS
        ============================ */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .mt-1 { margin-top: 8px; }
        .mt-2 { margin-top: 16px; }
        .mt-3 { margin-top: 24px; }
        .mt-4 { margin-top: 32px; }

        .mb-1 { margin-bottom: 8px; }
        .mb-2 { margin-bottom: 16px; }
        .mb-3 { margin-bottom: 24px; }
        .mb-4 { margin-bottom: 32px; }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-left: 4px solid var(--accent-green);
            padding: 16px 24px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow);
            z-index: 3000;
            animation: slideIn 0.3s ease-out;
            max-width: 400px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.error {
            border-left-color: var(--accent-red);
        }

        .notification.warning {
            border-left-color: var(--accent-yellow);
        }

        /* ============================
           RESPONSIVE DESIGN
        ============================ */
        @media (max-width: 768px) {
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .sport-tabs {
                padding-left: 16px;
                padding-right: 16px;
                margin-left: -16px;
                margin-right: -16px;
            }
            
            .match-odds {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .crash-controls {
                grid-template-columns: 1fr;
            }
            
            .auto-cashout {
                grid-column: span 1;
            }
            
            .profile-balance {
                font-size: 36px;
            }
            
            .dice-3d {
                width: 120px;
                height: 120px;
            }
            
            .dice-face {
                font-size: 48px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 12px;
            }
            
            .match-teams {
                flex-direction: column;
                gap: 16px;
            }
            
            .match-score {
                margin: 16px 0;
                flex-direction: row;
                gap: 20px;
            }
            
            .score-display {
                font-size: 24px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-bets {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Main App Container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-crown logo-icon"></i>
                    <span>Royal Bet</span>
                </div>
                <div class="balance-display">
                    <i class="fas fa-coins"></i>
                    <span>–ë–∞–ª–∞–Ω—Å: </span>
                    <span id="userBalance" class="balance-amount">5000 ‚ÇΩ</span>
                </div>
            </div>
        </header>

        <!-- Sports Tabs -->
        <div class="tab-navigation" id="mainTabs">
            <button class="tab-btn active" data-tab="sports">
                <i class="fas fa-futbol"></i> –°–ø–æ—Ä—Ç
            </button>
            <button class="tab-btn" data-tab="games">
                <i class="fas fa-gamepad"></i> –ò–≥—Ä—ã
            </button>
            <button class="tab-btn" data-tab="bets">
                <i class="fas fa-history"></i> –°—Ç–∞–≤–∫–∏
            </button>
            <button class="tab-btn" data-tab="profile">
                <i class="fas fa-user"></i> –ü—Ä–æ—Ñ–∏–ª—å
            </button>
        </div>

        <!-- Sports Section -->
        <section id="sportsSection" class="tab-content">
            <h1>–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</h1>
            
            <!-- Sport Type Tabs -->
            <div class="sport-tabs" id="sportTabs">
                <button class="sport-tab active" data-sport="all">–í—Å–µ</button>
                <button class="sport-tab" data-sport="football">‚öΩ –§—É—Ç–±–æ–ª</button>
                <button class="sport-tab" data-sport="hockey">üèí –•–æ–∫–∫–µ–π</button>
                <button class="sport-tab" data-sport="basketball">üèÄ –ë–∞—Å–∫–µ—Ç–±–æ–ª</button>
                <button class="sport-tab" data-sport="tennis">üéæ –¢–µ–Ω–Ω–∏—Å</button>
                <button class="sport-tab" data-sport="table_tennis">üèì –ù–∞—Å—Ç. —Ç–µ–Ω–Ω–∏—Å</button>
            </div>

            <!-- Matches Container -->
            <div id="matchesContainer">
                <!-- –ú–∞—Ç—á–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                <div class="text-center mt-4">
                    <div class="loading"></div>
                    <p class="mt-2">–ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç—á–µ–π...</p>
                </div>
            </div>
        </section>

        <!-- Games Section -->
        <section id="gamesSection" class="tab-content hidden">
            <h1>–ú–∏–Ω–∏-–∏–≥—Ä—ã</h1>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É –¥–ª—è –Ω–∞—á–∞–ª–∞</p>
            
            <div class="games-grid">
                <div class="game-card" data-game="mines">
                    <i class="fas fa-bomb game-icon"></i>
                    <h3 class="game-title">Mines</h3>
                    <p class="game-description">–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã, –∏–∑–±–µ–≥–∞—è –º–∏–Ω</p>
                </div>
                
                <div class="game-card" data-game="crash">
                    <i class="fas fa-plane game-icon"></i>
                    <h3 class="game-title">Crash</h3>
                    <p class="game-description">–£—Å–ø–µ–π—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ –¥–æ –∫—Ä–∞—Ö–∞ —Å–∞–º–æ–ª–µ—Ç–∞</p>
                </div>
                
                <div class="game-card" data-game="dice">
                    <i class="fas fa-dice game-icon"></i>
                    <h3 class="game-title">Dice</h3>
                    <p class="game-description">–£–≥–∞–¥–∞–π—Ç–µ —á–µ—Ç –∏–ª–∏ –Ω–µ—á–µ—Ç</p>
                </div>
                
                <div class="game-card" data-game="coming">
                    <i class="fas fa-plus game-icon"></i>
                    <h3 class="game-title">–°–∫–æ—Ä–æ</h3>
                    <p class="game-description">–ù–æ–≤—ã–µ –∏–≥—Ä—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>
                </div>
            </div>
        </section>

        <!-- Bets Section -->
        <section id="betsSection" class="tab-content hidden">
            <h1>–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</h1>
            
            <div class="tab-navigation">
                <button class="tab-btn active" data-history-type="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                <button class="tab-btn" data-history-type="won">–í—ã–∏–≥—Ä–∞–Ω–Ω—ã–µ</button>
                <button class="tab-btn" data-history-type="lost">–ü—Ä–æ–∏–≥—Ä–∞–Ω–Ω—ã–µ</button>
                <button class="tab-btn" data-history-type="all">–í—Å–µ</button>
            </div>
            
            <div id="betsHistoryContainer">
                <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profileSection" class="tab-content hidden">
            <div class="profile-header">
                <div class="profile-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <h2 id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
                <p>ID: <span id="userId">123456</span></p>
                <div class="profile-balance" id="profileBalance">5000 ‚ÇΩ</div>
                <button class="btn btn-primary" onclick="refreshBalance()">
                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
                </button>
            </div>
            
            <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalBets">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="wonBets">0</div>
                    <div class="stat-label">–í—ã–∏–≥—Ä–∞–Ω–æ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="winRate">0%</div>
                    <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalWon">0 ‚ÇΩ</div>
                    <div class="stat-label">–û–±—â–∏–π –≤—ã–∏–≥—Ä—ã—à</div>
                </div>
            </div>
            
            <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç–∞–≤–∫–∏</h2>
            <div id="recentBets">
                <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </section>

        <!-- Individual Game Screens -->
        
        <!-- Mines Game Screen -->
        <section id="minesGameScreen" class="tab-content hidden">
            <div class="mines-container">
                <div class="match-header">
                    <button class="btn btn-secondary btn-sm" onclick="goBackToGames()">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                    <h2>Mines</h2>
                    <div class="balance-display">
                        <span id="minesBalance">5000 ‚ÇΩ</span>
                    </div>
                </div>
                
                <div class="game-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="currentMultiplier">1.00x</div>
                        <div class="stat-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="potentialWin">0 ‚ÇΩ</div>
                        <div class="stat-label">–í—ã–∏–≥—Ä—ã—à</div>
                    </div>
                </div>
                
                <div class="mines-controls">
                    <button class="btn btn-secondary" id="decreaseMines">
                        <i class="fas fa-minus"></i>
                    </button>
                    
                    <div class="mines-slider">
                        <input type="range" id="minesSlider" min="3" max="24" value="3">
                    </div>
                    
                    <button class="btn btn-secondary" id="increaseMines">
                        <i class="fas fa-plus"></i>
                    </button>
                    
                    <div class="mines-count">
                        <span id="minesCount">3</span>
                    </div>
                </div>
                
                <div class="mines-grid" id="minesGrid">
                    <!-- –ü–æ–ª–µ 5x5 –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <div class="bet-input-container">
                    <input type="number" class="bet-amount-input" id="minesBetAmount" value="100" min="10" step="10">
                    <div class="quick-bets">
                        <div class="quick-bet" data-amount="10">10 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="50">50 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="100">100 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="500">500 ‚ÇΩ</div>
                    </div>
                </div>
                
                <div class="crash-controls">
                    <button class="btn btn-primary btn-block" id="startMinesGame">
                        <i class="fas fa-play"></i> –ò–≥—Ä–∞—Ç—å
                    </button>
                    <button class="btn btn-secondary btn-block" id="cashoutMines" disabled>
                        <i class="fas fa-money-bill-wave"></i> –ó–∞–±—Ä–∞—Ç—å
                    </button>
                </div>
            </div>
        </section>

        <!-- Dice Game Screen -->
        <section id="diceGameScreen" class="tab-content hidden">
            <div class="dice-container">
                <div class="match-header">
                    <button class="btn btn-secondary btn-sm" onclick="goBackToGames()">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                    <h2>Dice</h2>
                    <div class="balance-display">
                        <span id="diceBalance">5000 ‚ÇΩ</span>
                    </div>
                </div>
                
                <div class="dice-3d" id="dice3D">
                    <div class="dice-face face-1">1</div>
                    <div class="dice-face face-2">2</div>
                    <div class="dice-face face-3">3</div>
                    <div class="dice-face face-4">4</div>
                    <div class="dice-face face-5">5</div>
                    <div class="dice-face face-6">6</div>
                </div>
                
                <div class="dice-bets">
                    <div class="dice-bet-btn" data-bet="odd">
                        <i class="fas fa-dice-one dice-bet-icon"></i>
                        <h3>–ù–µ—á–µ—Ç</h3>
                        <p>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: 2.0x</p>
                    </div>
                    
                    <div class="dice-bet-btn" data-bet="even">
                        <i class="fas fa-dice-two dice-bet-icon"></i>
                        <h3>–ß–µ—Ç</h3>
                        <p>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: 2.0x</p>
                    </div>
                </div>
                
                <div class="bet-input-container">
                    <input type="number" class="bet-amount-input" id="diceBetAmount" value="100" min="10" step="10">
                    <div class="quick-bets">
                        <div class="quick-bet" data-amount="10">10 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="50">50 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="100">100 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="500">500 ‚ÇΩ</div>
                    </div>
                </div>
                
                <button class="btn btn-primary btn-block" id="rollDice">
                    <i class="fas fa-dice"></i> –ë—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫
                </button>
            </div>
        </section>

        <!-- Crash Game Screen -->
        <section id="crashGameScreen" class="tab-content hidden">
            <div class="crash-container">
                <div class="match-header">
                    <button class="btn btn-secondary btn-sm" onclick="goBackToGames()">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                    <h2>Crash</h2>
                    <div class="balance-display">
                        <span id="crashBalance">5000 ‚ÇΩ</span>
                    </div>
                </div>
                
                <div class="crash-canvas-container">
                    <canvas id="crashCanvas"></canvas>
                    <div class="crash-multiplier" id="crashMultiplier">1.00x</div>
                </div>
                
                <div class="auto-cashout">
                    <h3>–ê–≤—Ç–æ-–≤—ã–≤–æ–¥</h3>
                    <div class="mt-2">
                        <button class="btn btn-sm btn-secondary" id="decreaseAuto">-0.5x</button>
                        <input type="number" class="auto-input" id="autoCashoutValue" value="2.00" step="0.1" min="1.1">
                        <button class="btn btn-sm btn-secondary" id="increaseAuto">+0.5x</button>
                    </div>
                    <button class="btn btn-sm btn-secondary mt-2" id="toggleAutoCashout">
                        <i class="fas fa-power-off"></i> –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ-–≤—ã–≤–æ–¥
                    </button>
                </div>
                
                <div class="bet-input-container">
                    <input type="number" class="bet-amount-input" id="crashBetAmount" value="100" min="10" step="10">
                    <div class="quick-bets">
                        <div class="quick-bet" data-amount="10">10 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="50">50 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="100">100 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="500">500 ‚ÇΩ</div>
                    </div>
                </div>
                
                <div class="crash-controls">
                    <button class="btn btn-primary btn-block" id="startCrash">
                        <i class="fas fa-play"></i> –°—Ç–∞—Ä—Ç
                    </button>
                    <button class="btn btn-secondary btn-block" id="cashoutCrash" disabled>
                        <i class="fas fa-money-bill-wave"></i> –í—ã–≤–µ—Å—Ç–∏
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active" data-tab="sports">
            <i class="fas fa-futbol nav-icon"></i>
            <span>–°–ø–æ—Ä—Ç</span>
        </a>
        <a href="#" class="nav-item" data-tab="games">
            <i class="fas fa-gamepad nav-icon"></i>
            <span>–ò–≥—Ä—ã</span>
        </a>
        <a href="#" class="nav-item" data-tab="bets">
            <i class="fas fa-history nav-icon"></i>
            <span>–°—Ç–∞–≤–∫–∏</span>
        </a>
        <a href="#" class="nav-item" data-tab="profile">
            <i class="fas fa-user nav-icon"></i>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </a>
    </nav>

    <!-- Bet Modal -->
    <div id="betModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–†–∞–∑–º–µ—â–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏</h2>
                <button class="close-btn" onclick="closeBetModal()">&times;</button>
            </div>
            <div class="modal-body">
                <h3 id="betMatchTitle">–ú–∞—Ç—á</h3>
                <p id="betOutcomeInfo">–ò—Å—Ö–æ–¥: –ü–æ–±–µ–¥–∞ —Ö–æ–∑—è–µ–≤</p>
                <p>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: <span id="betOdds" class="balance-amount">2.00</span></p>
                
                <div class="bet-input-container">
                    <label for="betAmount">–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                    <input type="number" class="bet-amount-input" id="betModalAmount" value="50" min="50" step="10">
                    <div class="quick-bets">
                        <div class="quick-bet" data-amount="50">50 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="100">100 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="500">500 ‚ÇΩ</div>
                        <div class="quick-bet" data-amount="1000">1000 ‚ÇΩ</div>
                    </div>
                </div>
                
                <div class="mt-3">
                    <p>–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à: <span id="potentialWinAmount" class="balance-amount">100 ‚ÇΩ</span></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBetModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="placeBet()">–ü–æ—Å—Ç–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Express Bet Modal -->
    <div id="expressModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–≠–∫—Å–ø—Ä–µ—Å—Å —Å—Ç–∞–≤–∫–∞</h2>
                <button class="close-btn" onclick="closeExpressModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="expressBetsList"></div>
                <div class="mt-3">
                    <p>–û–±—â–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: <span id="expressTotalOdds" class="balance-amount">1.00</span></p>
                </div>
                
                <div class="bet-input-container">
                    <label for="expressAmount">–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                    <input type="number" class="bet-amount-input" id="expressAmount" value="50" min="50" step="10">
                </div>
                
                <div class="mt-3">
                    <p>–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à: <span id="expressPotentialWin" class="balance-amount">0 ‚ÇΩ</span></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeExpressModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="placeExpressBet()">–ü–æ—Å—Ç–∞–≤–∏—Ç—å —ç–∫—Å–ø—Ä–µ—Å—Å</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="modal-overlay hidden">
        <div class="modal-content" style="background: transparent; border: none; box-shadow: none;">
            <div class="text-center">
                <div class="loading" style="width: 60px; height: 60px; border-width: 5px;"></div>
                <p class="mt-3" style="font-size: 18px;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
        </div>
    </div>

    <script>
        // ============================
        // GLOBAL STATE & CONFIGURATION
        // ============================
        const config = {
            apiUrl: 'https://backend-4jag.onrender.com', // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à URL Render
            minSportBet: 50,
            minGameBet: 10,
            user: {
                id: null,
                username: null,
                balance: 5000
            },
            currentBet: {
                matchId: null,
                outcome: null,
                odds: null,
                matchTitle: null
            },
            expressBets: [],
            games: {
                mines: {
                    active: false,
                    betId: null,
                    field: [],
                    minesCount: 3,
                    revealedCells: 0
                },
                crash: {
                    active: false,
                    gameId: null,
                    crashPoint: null,
                    autoCashout: false,
                    autoCashoutValue: 2.0
                },
                dice: {
                    selectedBet: null
                }
            }
        };

        // ============================
        // NOTIFICATION SYSTEM
        // ============================
        function showNotification(message, type = 'info', duration = 5000) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-${type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'check-circle'}"></i>
                    <div>${message}</div>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease-out reverse';
                setTimeout(() => notification.remove(), 300);
            }, duration);
        }

        function showLoading() {
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }

        // ============================
        // TELEGRAM WEBAPP INTEGRATION
        // ============================
        function initTelegramWebApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                const webApp = window.Telegram.WebApp;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                webApp.ready();
                webApp.expand();
                
                // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const user = webApp.initDataUnsafe.user;
                if (user) {
                    config.user.id = user.id;
                    config.user.username = user.username || `user_${user.id}`;
                    config.user.firstName = user.first_name;
                    config.user.lastName = user.last_name;
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                    document.getElementById('userName').textContent = 
                        `${user.first_name || ''} ${user.last_name || ''}`.trim() || config.user.username;
                    document.getElementById('userId').textContent = user.id;
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –±—ç–∫–µ–Ω–¥–µ
                    initUser();
                }
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                webApp.setHeaderColor('#0e1015');
                webApp.setBackgroundColor('#0e1015');
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
                webApp.onEvent('viewportChanged', (event) => {
                    console.log('Viewport changed:', event);
                });
            } else {
                // –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
                console.log('Telegram WebApp not detected, using mock data');
                config.user.id = 123456789;
                config.user.username = 'test_user';
                config.user.firstName = '–¢–µ—Å—Ç–æ–≤—ã–π';
                config.user.lastName = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                
                document.getElementById('userName').textContent = '–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('userId').textContent = '123456789';
                
                initUser();
            }
        }

        // ============================
        // API INTEGRATION
        // ============================
        async function apiRequest(endpoint, method = 'GET', data = null) {
            const url = `${config.apiUrl}${endpoint}`;
            const options = {
                method,
                headers: {
                    'Content-Type': 'application/json',
                },
            };
            
            if (data) {
                options.body = JSON.stringify(data);
            }
            
            try {
                const response = await fetch(url, options);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.json();
            } catch (error) {
                console.error('API request failed:', error);
                throw error;
            }
        }

        async function initUser() {
            try {
                showLoading();
                const response = await apiRequest('/api/init', 'POST', {
                    initData: window.Telegram?.WebApp?.initData || 'mock'
                });
                
                if (response.success) {
                    config.user.id = response.user.id;
                    config.user.username = response.user.username;
                    config.user.balance = response.user.balance;
                    
                    updateBalanceDisplay();
                    loadMatches();
                    loadHistory('active');
                }
            } catch (error) {
                console.error('Failed to initialize user:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É', 'error');
            } finally {
                hideLoading();
            }
        }

        async function loadMatches(sport = 'all') {
            try {
                const endpoint = sport === 'all' ? '/api/matches' : `/api/matches?sport=${sport}`;
                const response = await apiRequest(endpoint);
                
                const container = document.getElementById('matchesContainer');
                if (!response.matches || response.matches.length === 0) {
                    container.innerHTML = `
                        <div class="text-center mt-4">
                            <i class="fas fa-calendar-times" style="font-size: 48px; color: var(--text-tertiary); margin-bottom: 16px;"></i>
                            <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = response.matches.map(match => createMatchCard(match)).join('');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
                document.querySelectorAll('.odds-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const matchId = this.dataset.matchId;
                        const outcome = this.dataset.outcome;
                        const odds = parseFloat(this.dataset.odds);
                        const match = response.matches.find(m => m.id == matchId);
                        
                        openBetModal(match, outcome, odds);
                    });
                });
            } catch (error) {
                console.error('Failed to load matches:', error);
                document.getElementById('matchesContainer').innerHTML = `
                    <div class="text-center mt-4">
                        <i class="fas fa-exclamation-triangle" style="font-size: 48px; color: var(--accent-red); margin-bottom: 16px;"></i>
                        <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞—Ç—á–µ–π</p>
                        <button class="btn btn-secondary mt-2" onclick="loadMatches()">
                            <i class="fas fa-sync-alt"></i> –ü–æ–≤—Ç–æ—Ä–∏—Ç—å
                        </button>
                    </div>
                `;
            }
        }

        async function placeBetApi(betData) {
            try {
                showLoading();
                const response = await apiRequest('/api/bet', 'POST', {
                    user_id: config.user.id,
                    ...betData
                });
                
                if (response.success) {
                    config.user.balance = response.new_balance;
                    updateBalanceDisplay();
                    showNotification(`–°—Ç–∞–≤–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞! –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à: ${response.potential_win} ‚ÇΩ`, 'info');
                    closeBetModal();
                    return true;
                }
            } catch (error) {
                console.error('Failed to place bet:', error);
                showNotification(error.message || '–û—à–∏–±–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏', 'error');
                return false;
            } finally {
                hideLoading();
            }
        }

        async function loadHistory(type = 'active') {
            try {
                const response = await apiRequest(`/api/history?user_id=${config.user.id}&limit=50`);
                const container = document.getElementById('betsHistoryContainer');
                
                if (!response.history || response.history.length === 0) {
                    container.innerHTML = `
                        <div class="text-center mt-4">
                            <i class="fas fa-history" style="font-size: 48px; color: var(--text-tertiary); margin-bottom: 16px;"></i>
                            <p>–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ –ø—É—Å—Ç–∞</p>
                        </div>
                    `;
                    return;
                }
                
                let filteredHistory = response.history;
                if (type !== 'all') {
                    filteredHistory = response.history.filter(bet => bet.status === type);
                }
                
                container.innerHTML = filteredHistory.map(bet => createHistoryItem(bet)).join('');
                
            } catch (error) {
                console.error('Failed to load history:', error);
            }
        }

        async function refreshBalance() {
            try {
                const response = await apiRequest(`/api/balance?user_id=${config.user.id}`);
                config.user.balance = response.balance;
                updateBalanceDisplay();
                showNotification('–ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω', 'info');
            } catch (error) {
                console.error('Failed to refresh balance:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞', 'error');
            }
        }

        // ============================
        // UI COMPONENTS
        // ============================
        function createMatchCard(match) {
            const statusClass = match.status === 'live' ? 'status-live' : 'status-scheduled';
            const statusText = match.status === 'live' ? 'LIVE' : formatTime(match.start_time);
            
            let scoreDisplay = `${match.score_home} : ${match.score_away}`;
            if (match.sport === 'tennis' || match.sport === 'table_tennis') {
                // –î–ª—è —Ç–µ–Ω–Ω–∏—Å–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ—Ç—ã
                if (match.score_details && match.score_details.sets) {
                    const sets = match.score_details.sets;
                    scoreDisplay = `${match.score_home} : ${match.score_away} (${sets.map(s => `${s.home}:${s.away}`).join(', ')})`;
                }
            }
            
            return `
                <div class="card match-card">
                    <div class="match-header">
                        <div class="match-sport">${getSportIcon(match.sport)} ${getSportName(match.sport)}</div>
                        <div class="match-status ${statusClass}">${statusText}</div>
                    </div>
                    
                    <div class="match-teams">
                        <div class="team">
                            <div class="team-logo">${match.team_home.charAt(0)}</div>
                            <div class="team-name">${match.team_home}</div>
                        </div>
                        
                        <div class="match-score">
                            <div class="score-display">${scoreDisplay}</div>
                            <div class="match-time">${match.period || '1-–π —Ç–∞–π–º'}</div>
                        </div>
                        
                        <div class="team">
                            <div class="team-logo">${match.team_away.charAt(0)}</div>
                            <div class="team-name">${match.team_away}</div>
                        </div>
                    </div>
                    
                    <div class="match-odds">
                        <div class="odds-btn" data-match-id="${match.id}" data-outcome="home" data-odds="${match.odds_home}">
                            <div class="odds-type">–ü1</div>
                            <div class="odds-value">${match.odds_home.toFixed(2)}</div>
                        </div>
                        
                        ${match.odds_draw ? `
                        <div class="odds-btn" data-match-id="${match.id}" data-outcome="draw" data-odds="${match.odds_draw}">
                            <div class="odds-type">X</div>
                            <div class="odds-value">${match.odds_draw.toFixed(2)}</div>
                        </div>
                        ` : `
                        <div class="odds-btn" style="opacity: 0.5; cursor: default;">
                            <div class="odds-type">X</div>
                            <div class="odds-value">-</div>
                        </div>
                        `}
                        
                        <div class="odds-btn" data-match-id="${match.id}" data-outcome="away" data-odds="${match.odds_away}">
                            <div class="odds-type">–ü2</div>
                            <div class="odds-value">${match.odds_away.toFixed(2)}</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-secondary btn-block mt-2" onclick="showMatchDetails(${match.id})">
                        <i class="fas fa-chart-bar"></i> –î–µ—Ç–∞–ª–∏ –∏ –¥–æ–ø. —Å—Ç–∞–≤–∫–∏
                    </button>
                </div>
            `;
        }

        function createHistoryItem(bet) {
            const statusClass = bet.status;
            const statusIcon = bet.status === 'won' ? 'fa-check-circle' : 
                             bet.status === 'lost' ? 'fa-times-circle' : 'fa-clock';
            const statusColor = bet.status === 'won' ? 'var(--accent-green)' : 
                              bet.status === 'lost' ? 'var(--accent-red)' : 'var(--accent-blue)';
            
            let betInfo = '';
            if (bet.game_type === 'sport' && bet.match_info) {
                betInfo = `${bet.match_info.teams} (${bet.outcome})`;
            } else {
                betInfo = `${getGameName(bet.game_type)}: ${bet.outcome}`;
            }
            
            return `
                <div class="history-item ${statusClass}">
                    <div style="flex: 1;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas ${statusIcon}" style="color: ${statusColor};"></i>
                            <div>
                                <div style="font-weight: 600;">${betInfo}</div>
                                <small>${new Date(bet.created_at).toLocaleString()}</small>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: 700; color: ${statusColor};">${bet.amount} ‚ÇΩ</div>
                        <small>–ö–æ—ç—Ñ: ${bet.odds.toFixed(2)}</small>
                    </div>
                </div>
            `;
        }

        // ============================
        // BET MODAL FUNCTIONS
        // ============================
        function openBetModal(match, outcome, odds) {
            const modal = document.getElementById('betModal');
            const matchTitle = `${match.team_home} vs ${match.team_away}`;
            const outcomeText = getOutcomeText(outcome);
            
            document.getElementById('betMatchTitle').textContent = matchTitle;
            document.getElementById('betOutcomeInfo').textContent = `–ò—Å—Ö–æ–¥: ${outcomeText}`;
            document.getElementById('betOdds').textContent = odds.toFixed(2);
            
            config.currentBet.matchId = match.id;
            config.currentBet.outcome = outcome;
            config.currentBet.odds = odds;
            config.currentBet.matchTitle = matchTitle;
            
            updatePotentialWin();
            modal.classList.remove('hidden');
        }

        function closeBetModal() {
            document.getElementById('betModal').classList.add('hidden');
            config.currentBet = {
                matchId: null,
                outcome: null,
                odds: null,
                matchTitle: null
            };
        }

        function updatePotentialWin() {
            const amount = parseFloat(document.getElementById('betModalAmount').value) || 0;
            const odds = config.currentBet.odds || 1;
            const potentialWin = amount * odds;
            
            document.getElementById('potentialWinAmount').textContent = `${potentialWin.toFixed(2)} ‚ÇΩ`;
        }

        async function placeBet() {
            const amount = parseFloat(document.getElementById('betModalAmount').value);
            
            if (amount < config.minSportBet) {
                showNotification(`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${config.minSportBet} ‚ÇΩ`, 'error');
                return;
            }
            
            if (amount > config.user.balance) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤', 'error');
                return;
            }
            
            const success = await placeBetApi({
                match_id: config.currentBet.matchId,
                game_type: 'sport',
                amount: amount,
                outcome: config.currentBet.outcome,
                odds: config.currentBet.odds
            });
            
            if (success) {
                loadHistory('active');
            }
        }

        // ============================
        // GAMES FUNCTIONS
        // ============================
        function openGameScreen(game) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –∏–≥—Ä—É
            document.getElementById(`${game}GameScreen`).classList.remove('hidden');
            
            // –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∏–≥—Ä—ã
            updateGameBalance(game);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä—É
            if (game === 'mines') {
                initMinesGame();
            } else if (game === 'dice') {
                initDiceGame();
            } else if (game === 'crash') {
                initCrashGame();
            }
        }

        function goBackToGames() {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –∏–≥—Ä
            document.getElementById('minesGameScreen').classList.add('hidden');
            document.getElementById('diceGameScreen').classList.add('hidden');
            document.getElementById('crashGameScreen').classList.add('hidden');
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –∏–≥—Ä
            document.getElementById('gamesSection').classList.remove('hidden');
            
            // –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
            updateBalanceDisplay();
        }

        // ============================
        // MINES GAME
        // ============================
        function initMinesGame() {
            const grid = document.getElementById('minesGrid');
            grid.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –ø–æ–ª–µ 5x5
            for (let i = 0; i < 25; i++) {
                const cell = document.createElement('div');
                cell.className = 'mine-cell';
                cell.dataset.index = i;
                cell.innerHTML = '<i class="fas fa-gem"></i>';
                cell.addEventListener('click', () => revealMineCell(i));
                grid.appendChild(cell);
            }
            
            // –°–ª–∞–π–¥–µ—Ä –º–∏–Ω
            const slider = document.getElementById('minesSlider');
            const minesCountDisplay = document.getElementById('minesCount');
            
            slider.addEventListener('input', function() {
                const count = parseInt(this.value);
                minesCountDisplay.textContent = count;
                config.games.mines.minesCount = count;
                updateMinesMultiplier();
            });
            
            // –ö–Ω–æ–ø–∫–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏—è/—É–º–µ–Ω—å—à–µ–Ω–∏—è
            document.getElementById('increaseMines').addEventListener('click', () => {
                if (slider.value < 24) {
                    slider.value = parseInt(slider.value) + 1;
                    slider.dispatchEvent(new Event('input'));
                }
            });
            
            document.getElementById('decreaseMines').addEventListener('click', () => {
                if (slider.value > 3) {
                    slider.value = parseInt(slider.value) - 1;
                    slider.dispatchEvent(new Event('input'));
                }
            });
            
            // –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏
            document.querySelectorAll('#minesGameScreen .quick-bet').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('minesBetAmount').value = this.dataset.amount;
                    updateMinesPotentialWin();
                });
            });
            
            // –í–≤–æ–¥ —Å—É–º–º—ã —Å—Ç–∞–≤–∫–∏
            document.getElementById('minesBetAmount').addEventListener('input', updateMinesPotentialWin);
            
            // –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞
            document.getElementById('startMinesGame').addEventListener('click', startMinesGame);
            
            // –ö–Ω–æ–ø–∫–∞ –≤—ã–≤–æ–¥–∞
            document.getElementById('cashoutMines').addEventListener('click', cashoutMines);
            
            updateMinesMultiplier();
        }

        function updateMinesMultiplier() {
            const cells = 25;
            const safeCells = cells - config.games.mines.minesCount;
            const probability = safeCells / cells;
            const multiplier = (1 / probability).toFixed(2);
            
            document.getElementById('currentMultiplier').textContent = `${multiplier}x`;
            updateMinesPotentialWin();
        }

        function updateMinesPotentialWin() {
            const amount = parseFloat(document.getElementById('minesBetAmount').value) || 0;
            const multiplier = parseFloat(document.getElementById('currentMultiplier').textContent);
            const potentialWin = amount * multiplier;
            
            document.getElementById('potentialWin').textContent = `${potentialWin.toFixed(2)} ‚ÇΩ`;
        }

        async function startMinesGame() {
            if (config.games.mines.active) {
                showNotification('–ò–≥—Ä–∞ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–∞', 'warning');
                return;
            }
            
            const amount = parseFloat(document.getElementById('minesBetAmount').value);
            
            if (amount < config.minGameBet) {
                showNotification(`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${config.minGameBet} ‚ÇΩ`, 'error');
                return;
            }
            
            if (amount > config.user.balance) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤', 'error');
                return;
            }
            
            try {
                showLoading();
                const response = await apiRequest('/api/game', 'POST', {
                    user_id: config.user.id,
                    game_type: 'mines',
                    amount: amount,
                    mines_count: config.games.mines.minesCount
                });
                
                if (response.success) {
                    config.games.mines.active = true;
                    config.games.mines.betId = response.bet_id;
                    config.games.mines.field = response.field;
                    config.games.mines.revealedCells = 0;
                    
                    config.user.balance = response.new_balance;
                    updateGameBalance('mines');
                    updateBalanceDisplay();
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É –≤—ã–≤–æ–¥–∞
                    document.getElementById('cashoutMines').disabled = false;
                    document.getElementById('startMinesGame').disabled = true;
                    
                    showNotification('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –∫–ª–µ—Ç–∫–∏', 'info');
                }
            } catch (error) {
                console.error('Failed to start mines game:', error);
                showNotification(error.message || '–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã', 'error');
            } finally {
                hideLoading();
            }
        }

        function revealMineCell(index) {
            if (!config.games.mines.active) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É', 'warning');
                return;
            }
            
            const cell = document.querySelector(`.mine-cell[data-index="${index}"]`);
            if (cell.classList.contains('revealed') || cell.classList.contains('safe')) {
                return;
            }
            
            if (config.games.mines.field[index] === 1) {
                // –ú–∏–Ω–∞ - –ø—Ä–æ–∏–≥—Ä—ã—à
                cell.classList.add('revealed');
                cell.innerHTML = '<i class="fas fa-bomb"></i>';
                cell.style.background = 'var(--accent-red)';
                
                config.games.mines.active = false;
                document.getElementById('cashoutMines').disabled = true;
                document.getElementById('startMinesGame').disabled = false;
                
                showNotification('–í—ã –Ω–∞—Ç–∫–Ω—É–ª–∏—Å—å –Ω–∞ –º–∏–Ω—É! –°—Ç–∞–≤–∫–∞ –ø—Ä–æ–∏–≥—Ä–∞–Ω–∞', 'error');
                
                // –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
                refreshBalance();
                
            } else {
                // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–ª–µ—Ç–∫–∞
                cell.classList.add('safe');
                cell.innerHTML = '<i class="fas fa-gem"></i>';
                cell.style.background = 'var(--accent-green)';
                cell.style.color = 'var(--bg-primary)';
                
                config.games.mines.revealedCells++;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã–∏–≥—Ä—ã—à –≤—Å–µ—Ö –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫
                const safeCells = 25 - config.games.mines.minesCount;
                if (config.games.mines.revealedCells === safeCells) {
                    // –í—Å–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ –æ—Ç–∫—Ä—ã—Ç—ã - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥
                    cashoutMines();
                }
            }
        }

        async function cashoutMines() {
            if (!config.games.mines.active || !config.games.mines.betId) {
                showNotification('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∏–≥—Ä—ã –¥–ª—è –≤—ã–≤–æ–¥–∞', 'warning');
                return;
            }
            
            try {
                showLoading();
                const response = await apiRequest('/api/mines/cashout', 'POST', {
                    user_id: config.user.id,
                    crash_id: config.games.mines.betId
                });
                
                if (response.success) {
                    config.games.mines.active = false;
                    config.user.balance = response.new_balance;
                    
                    updateGameBalance('mines');
                    updateBalanceDisplay();
                    
                    document.getElementById('cashoutMines').disabled = true;
                    document.getElementById('startMinesGame').disabled = false;
                    
                    showNotification(`–í—ã–∏–≥—Ä—ã—à: ${response.win_amount} ‚ÇΩ`, 'info');
                }
            } catch (error) {
                console.error('Failed to cashout mines:', error);
                showNotification(error.message || '–û—à–∏–±–∫–∞ –≤—ã–≤–æ–¥–∞', 'error');
            } finally {
                hideLoading();
            }
        }

        // ============================
        // DICE GAME
        // ============================
        function initDiceGame() {
            // –í—ã–±–æ—Ä —Å—Ç–∞–≤–∫–∏ (—á–µ—Ç/–Ω–µ—á–µ—Ç)
            document.querySelectorAll('.dice-bet-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.dice-bet-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    config.games.dice.selectedBet = this.dataset.bet;
                });
            });
            
            // –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏
            document.querySelectorAll('#diceGameScreen .quick-bet').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('diceBetAmount').value = this.dataset.amount;
                });
            });
            
            // –ö–Ω–æ–ø–∫–∞ –±—Ä–æ—Å–∫–∞
            document.getElementById('rollDice').addEventListener('click', rollDice);
        }

        async function rollDice() {
            const amount = parseFloat(document.getElementById('diceBetAmount').value);
            const betType = config.games.dice.selectedBet;
            
            if (!betType) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å—Ç–∞–≤–∫–∏ (—á–µ—Ç/–Ω–µ—á–µ—Ç)', 'warning');
                return;
            }
            
            if (amount < config.minGameBet) {
                showNotification(`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${config.minGameBet} ‚ÇΩ`, 'error');
                return;
            }
            
            if (amount > config.user.balance) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤', 'error');
                return;
            }
            
            try {
                showLoading();
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –±—Ä–æ—Å–∫–∞ –∫—É–±–∏–∫–∞
                const dice = document.getElementById('dice3D');
                dice.style.transition = 'transform 2s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                dice.style.transform = `rotateX(${Math.random() * 3600}deg) rotateY(${Math.random() * 3600}deg) rotateZ(${Math.random() * 3600}deg)`;
                
                const response = await apiRequest('/api/game', 'POST', {
                    user_id: config.user.id,
                    game_type: 'dice',
                    amount: amount,
                    dice_bet: betType
                });
                
                if (response.success) {
                    // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫—É–±–∏–∫ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
                    setTimeout(() => {
                        const face = response.dice_result;
                        const rotations = {
                            1: 'rotateX(0deg) rotateY(0deg)',
                            2: 'rotateY(-90deg)',
                            3: 'rotateY(-180deg)',
                            4: 'rotateY(90deg)',
                            5: 'rotateX(-90deg)',
                            6: 'rotateX(90deg)'
                        };
                        
                        dice.style.transition = 'transform 1s ease-out';
                        dice.style.transform = rotations[face];
                    }, 1500);
                    
                    config.user.balance = response.new_balance;
                    updateGameBalance('dice');
                    updateBalanceDisplay();
                    
                    if (response.win) {
                        showNotification(`–í—ã–∏–≥—Ä—ã—à! –í—ã–ø–∞–ª–æ ${response.dice_result}. –í—ã–∏–≥—Ä—ã—à: ${response.win_amount} ‚ÇΩ`, 'info');
                    } else {
                        showNotification(`–ü—Ä–æ–∏–≥—Ä—ã—à. –í—ã–ø–∞–ª–æ ${response.dice_result}`, 'error');
                    }
                }
            } catch (error) {
                console.error('Failed to roll dice:', error);
                showNotification(error.message || '–û—à–∏–±–∫–∞ –∏–≥—Ä—ã', 'error');
            } finally {
                setTimeout(() => hideLoading(), 2000);
            }
        }

        // ============================
        // CRASH GAME
        // ============================
        let crashCanvas, crashCtx;
        let crashAnimationId = null;
        let crashMultiplier = 1.0;
        let crashStartTime = null;

        function initCrashGame() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Canvas
            crashCanvas = document.getElementById('crashCanvas');
            crashCtx = crashCanvas.getContext('2d');
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ Canvas
            function resizeCanvas() {
                crashCanvas.width = crashCanvas.offsetWidth;
                crashCanvas.height = crashCanvas.offsetHeight;
                drawCrashGraph();
            }
            
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ-–≤—ã–≤–æ–¥–æ–º
            document.getElementById('decreaseAuto').addEventListener('click', () => {
                const input = document.getElementById('autoCashoutValue');
                input.value = (parseFloat(input.value) - 0.5).toFixed(1);
            });
            
            document.getElementById('increaseAuto').addEventListener('click', () => {
                const input = document.getElementById('autoCashoutValue');
                input.value = (parseFloat(input.value) + 0.5).toFixed(1);
            });
            
            document.getElementById('toggleAutoCashout').addEventListener('click', function() {
                config.games.crash.autoCashout = !config.games.crash.autoCashout;
                this.innerHTML = config.games.crash.autoCashout ? 
                    '<i class="fas fa-power-off"></i> –í—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ-–≤—ã–≤–æ–¥' :
                    '<i class="fas fa-power-off"></i> –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ-–≤—ã–≤–æ–¥';
                
                this.classList.toggle('active', config.games.crash.autoCashout);
            });
            
            // –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏
            document.querySelectorAll('#crashGameScreen .quick-bet').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('crashBetAmount').value = this.dataset.amount;
                });
            });
            
            // –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ä—Ç–∞ –∏ –≤—ã–≤–æ–¥–∞
            document.getElementById('startCrash').addEventListener('click', startCrash);
            document.getElementById('cashoutCrash').addEventListener('click', cashoutCrash);
        }

        function drawCrashGraph() {
            if (!crashCanvas || !crashCtx) return;
            
            const width = crashCanvas.width;
            const height = crashCanvas.height;
            
            // –û—á–∏—Å—Ç–∫–∞
            crashCtx.clearRect(0, 0, width, height);
            
            // –§–æ–Ω
            crashCtx.fillStyle = 'var(--bg-tertiary)';
            crashCtx.fillRect(0, 0, width, height);
            
            // –°–µ—Ç–∫–∞
            crashCtx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            crashCtx.lineWidth = 1;
            
            // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let i = 1; i < 5; i++) {
                const y = (height / 5) * i;
                crashCtx.beginPath();
                crashCtx.moveTo(0, y);
                crashCtx.lineTo(width, y);
                crashCtx.stroke();
            }
            
            // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let i = 1; i < 10; i++) {
                const x = (width / 10) * i;
                crashCtx.beginPath();
                crashCtx.moveTo(x, 0);
                crashCtx.lineTo(x, height);
                crashCtx.stroke();
            }
            
            // –ì—Ä–∞—Ñ–∏–∫ –∫—Ä–∞—à–∞
            if (config.games.crash.active && crashStartTime) {
                const timeElapsed = (Date.now() - crashStartTime) / 1000;
                crashMultiplier = Math.exp(timeElapsed * 0.05); // –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç
                
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ —Ç–æ—á–∫–µ –∫—Ä–∞—à–∞
                if (config.games.crash.crashPoint && crashMultiplier >= config.games.crash.crashPoint) {
                    crashMultiplier = config.games.crash.crashPoint;
                    endCrashGame();
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ-–≤—ã–≤–æ–¥–∞
                if (config.games.crash.autoCashout && 
                    crashMultiplier >= config.games.crash.autoCashoutValue) {
                    cashoutCrash();
                }
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞
                crashCtx.strokeStyle = 'var(--accent-green)';
                crashCtx.lineWidth = 3;
                crashCtx.beginPath();
                
                const points = [];
                for (let i = 0; i <= timeElapsed * 10; i++) {
                    const x = (i / (timeElapsed * 10)) * width;
                    const t = i / 10;
                    const yMultiplier = Math.exp(t * 0.05);
                    const y = height - (yMultiplier / 10) * height; // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
                    
                    points.push({x, y});
                    
                    if (i === 0) {
                        crashCtx.moveTo(x, y);
                    } else {
                        crashCtx.lineTo(x, y);
                    }
                }
                
                crashCtx.stroke();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è
                document.getElementById('crashMultiplier').textContent = `${crashMultiplier.toFixed(2)}x`;
                
                // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                crashAnimationId = requestAnimationFrame(drawCrashGraph);
            } else {
                // –°—Ç–∞—Ç–∏—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
                crashCtx.strokeStyle = 'var(--accent-green)';
                crashCtx.lineWidth = 2;
                crashCtx.beginPath();
                crashCtx.moveTo(0, height);
                crashCtx.bezierCurveTo(width * 0.3, height * 0.7, width * 0.7, height * 0.3, width, 0);
                crashCtx.stroke();
                
                document.getElementById('crashMultiplier').textContent = '1.00x';
            }
        }

        async function startCrash() {
            if (config.games.crash.active) {
                showNotification('–ò–≥—Ä–∞ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–∞', 'warning');
                return;
            }
            
            const amount = parseFloat(document.getElementById('crashBetAmount').value);
            
            if (amount < config.minGameBet) {
                showNotification(`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${config.minGameBet} ‚ÇΩ`, 'error');
                return;
            }
            
            if (amount > config.user.balance) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤', 'error');
                return;
            }
            
            try {
                showLoading();
                const response = await apiRequest('/api/crash/start', 'POST', {
                    user_id: config.user.id,
                    game_type: 'crash',
                    amount: amount
                });
                
                if (response.success) {
                    config.games.crash.active = true;
                    config.games.crash.gameId = response.game_id;
                    config.games.crash.crashPoint = response.crash_point;
                    
                    config.user.balance -= amount;
                    updateGameBalance('crash');
                    updateBalanceDisplay();
                    
                    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –≤—ã–≤–æ–¥–∞
                    document.getElementById('cashoutCrash').disabled = false;
                    document.getElementById('startCrash').disabled = true;
                    
                    // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
                    crashStartTime = Date.now();
                    crashMultiplier = 1.0;
                    drawCrashGraph();
                    
                    showNotification('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!', 'info');
                }
            } catch (error) {
                console.error('Failed to start crash game:', error);
                showNotification(error.message || '–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã', 'error');
            } finally {
                hideLoading();
            }
        }

        function endCrashGame() {
            config.games.crash.active = false;
            document.getElementById('cashoutCrash').disabled = true;
            document.getElementById('startCrash').disabled = false;
            
            if (crashAnimationId) {
                cancelAnimationFrame(crashAnimationId);
                crashAnimationId = null;
            }
            
            showNotification(`–ö—Ä–∞—Ö! –°–∞–º–æ–ª–µ—Ç —É–ø–∞–ª –Ω–∞ –º–Ω–æ–∂–∏—Ç–µ–ª–µ ${crashMultiplier.toFixed(2)}x`, 'error');
            
            // –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
            refreshBalance();
        }

        async function cashoutCrash() {
            if (!config.games.crash.active || !config.games.crash.gameId) {
                showNotification('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∏–≥—Ä—ã –¥–ª—è –≤—ã–≤–æ–¥–∞', 'warning');
                return;
            }
            
            try {
                showLoading();
                const response = await apiRequest('/api/crash/cashout', 'POST', {
                    user_id: config.user.id,
                    crash_id: config.games.crash.gameId
                });
                
                if (response.success) {
                    config.games.crash.active = false;
                    config.user.balance = response.new_balance;
                    
                    updateGameBalance('crash');
                    updateBalanceDisplay();
                    
                    document.getElementById('cashoutCrash').disabled = true;
                    document.getElementById('startCrash').disabled = false;
                    
                    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
                    if (crashAnimationId) {
                        cancelAnimationFrame(crashAnimationId);
                        crashAnimationId = null;
                    }
                    
                    showNotification(`–í—ã–≤–µ–¥–µ–Ω–æ –Ω–∞ –º–Ω–æ–∂–∏—Ç–µ–ª–µ ${response.multiplier}x! –í—ã–∏–≥—Ä—ã—à: ${response.win_amount} ‚ÇΩ`, 'info');
                }
            } catch (error) {
                console.error('Failed to cashout crash:', error);
                showNotification(error.message || '–û—à–∏–±–∫–∞ –≤—ã–≤–æ–¥–∞', 'error');
            } finally {
                hideLoading();
            }
        }

        // ============================
        // UTILITY FUNCTIONS
        // ============================
        function getSportIcon(sport) {
            const icons = {
                football: '‚öΩ',
                hockey: 'üèí',
                basketball: 'üèÄ',
                tennis: 'üéæ',
                table_tennis: 'üèì'
            };
            return icons[sport] || 'üéØ';
        }

        function getSportName(sport) {
            const names = {
                football: '–§—É—Ç–±–æ–ª',
                hockey: '–•–æ–∫–∫–µ–π',
                basketball: '–ë–∞—Å–∫–µ—Ç–±–æ–ª',
                tennis: '–¢–µ–Ω–Ω–∏—Å',
                table_tennis: '–ù–∞—Å—Ç. —Ç–µ–Ω–Ω–∏—Å'
            };
            return names[sport] || sport;
        }

        function getGameName(gameType) {
            const names = {
                mines: 'Mines',
                dice: 'Dice',
                crash: 'Crash',
                sport: '–°–ø–æ—Ä—Ç'
            };
            return names[gameType] || gameType;
        }

        function getOutcomeText(outcome) {
            const texts = {
                home: '–ü–æ–±–µ–¥–∞ —Ö–æ–∑—è–µ–≤',
                away: '–ü–æ–±–µ–¥–∞ –≥–æ—Å—Ç–µ–π',
                draw: '–ù–∏—á—å—è',
                odd: '–ù–µ—á–µ—Ç',
                even: '–ß–µ—Ç'
            };
            return texts[outcome] || outcome;
        }

        function formatTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffHours = Math.floor((date - now) / (1000 * 60 * 60));
            
            if (diffHours < 24) {
                return `–ß–µ—Ä–µ–∑ ${diffHours}—á`;
            } else {
                return date.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
        }

        function updateBalanceDisplay() {
            document.getElementById('userBalance').textContent = `${config.user.balance.toFixed(2)} ‚ÇΩ`;
            document.getElementById('profileBalance').textContent = `${config.user.balance.toFixed(2)} ‚ÇΩ`;
        }

        function updateGameBalance(game) {
            document.getElementById(`${game}Balance`).textContent = `${config.user.balance.toFixed(2)} ‚ÇΩ`;
        }

        function showMatchDetails(matchId) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –º–∞—Ç—á–∞
            showNotification('–î–µ—Ç–∞–ª–∏ –º–∞—Ç—á–∞ –∏ –¥–æ–ø. —Å—Ç–∞–≤–∫–∏ —Å–∫–æ—Ä–æ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã', 'info');
        }

        // ============================
        // EVENT LISTENERS
        // ============================
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
            initTelegramWebApp();
            
            // –û—Å–Ω–æ–≤–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-btn, .nav-item').forEach(element => {
                element.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const tab = this.dataset.tab;
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
                    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                    
                    this.classList.add('active');
                    
                    // –ù–∞–π—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π nav-item –∏–ª–∏ tab-btn
                    if (this.classList.contains('tab-btn')) {
                        const correspondingNav = document.querySelector(`.nav-item[data-tab="${tab}"]`);
                        if (correspondingNav) correspondingNav.classList.add('active');
                    } else {
                        const correspondingTab = document.querySelector(`.tab-btn[data-tab="${tab}"]`);
                        if (correspondingTab) correspondingTab.classList.add('active');
                    }
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
                    document.querySelectorAll('.tab-content').forEach(section => {
                        section.classList.add('hidden');
                    });
                    
                    document.getElementById(`${tab}Section`).classList.remove('hidden');
                    
                    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–µ–∫—Ü–∏–∏
                    if (tab === 'sports') {
                        loadMatches();
                    } else if (tab === 'bets') {
                        loadHistory('active');
                    } else if (tab === 'profile') {
                        refreshBalance();
                    }
                });
            });
            
            // –í–∫–ª–∞–¥–∫–∏ –≤–∏–¥–æ–≤ —Å–ø–æ—Ä—Ç–∞
            document.querySelectorAll('.sport-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.sport-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const sport = this.dataset.sport;
                    loadMatches(sport);
                });
            });
            
            // –ö–∞—Ä—Ç–æ—á–∫–∏ –∏–≥—Ä
            document.querySelectorAll('.game-card').forEach(card => {
                card.addEventListener('click', function() {
                    const game = this.dataset.game;
                    if (game === 'coming') {
                        showNotification('–ù–æ–≤–∞—è –∏–≥—Ä–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
                    } else {
                        openGameScreen(game);
                    }
                });
            });
            
            // –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏ –≤ –º–æ–¥–∞–ª–∫–µ
            document.querySelectorAll('#betModal .quick-bet').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('betModalAmount').value = this.dataset.amount;
                    updatePotentialWin();
                });
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—É–º–º—ã
            document.getElementById('betModalAmount').addEventListener('input', updatePotentialWin);
            
            // –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫
            document.querySelectorAll('[data-history-type]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('[data-history-type]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const type = this.dataset.historyType;
                    loadHistory(type);
                });
            });
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–µ–π –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (!document.getElementById('sportsSection').classList.contains('hidden')) {
                    const activeSport = document.querySelector('.sport-tab.active').dataset.sport;
                    loadMatches(activeSport);
                }
            }, 30000);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            setInterval(() => {
                refreshBalance();
            }, 60000);
        });

        // ============================
        // INITIALIZATION
        // ============================
        window.addEventListener('load', () => {
            console.log('Royal Bet Mini App loaded');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ canvas
            if (!document.createElement('canvas').getContext) {
                showNotification('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Canvas. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–≥—Ä—ã –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å.', 'warning');
            }
        });
    </script>
</body>
</html>
